#!/bin/bash -x
cat g/canonical.txt | while read dir canon branch; do
    (cd $dir && [ $(git branch --show-current) = $branch ] && git push canon $branch) && (cd $canon; [ $(git branch --show-current) = $branch ] && git reset --soft)
done
